<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Javier  Cabrera Arteaga | Obfuscation experiment for some cryptominers.</title>
<meta name="description" content="We use wasm-mutate to generate a 18877 variants from a seed cryptominer. The generated "population" has a particular property, all behave equally. When a Wasm variant is executed, it then returns the same result as the original program.
">

<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Styles -->
<link rel="shortcut icon" href="/assets/img/favicon.ico">
<link rel="stylesheet" href="/assets/css/main.css">

<link rel="canonical" href="/blog/2021/LazyTown/">

<!-- Open Graph -->

<meta property="og:site_name" content="Personal blog
We use wasm-mutate to generate a 18877 variants from a seed cryptominer. The generated "population" has a particular property, all behave equally. When a Wasm variant is executed, it then returns the same result as the original program.
" />
<meta property="og:type" content="object" />
<meta property="og:title" content="Obfuscation experiment for some cryptominers." />
<meta property="og:url" content="/blog/2021/LazyTown/" />
<meta name="description" property="og:description" content="We use wasm-mutate to generate a 18877 variants from a seed cryptominer. The generated "population" has a particular property, all behave equally. When a Wasm variant is executed, it then returns the same result as the original program.
" />
<meta name="author" content="Javier Cabrera-Arteaga">
<meta name="image" property="og:image" content="" />


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light bg-white navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="/">
       <span class="font-weight-bold">Javier</span>   Cabrera Arteaga PhD 
      </a>
      
      <!-- Navbar Toogle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              About
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">
              Blog
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/cv/">
                CV
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/thesis/">
                Lic Thesis
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/pthesis/">
                PhD Thesis
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                Projects
                
              </a>
          </li>
          
          
          
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      

<div class="post">

  <header class="post-header">
    <h1 class="post-title">Obfuscation experiment for some cryptominers.</h1>
    <p class="post-meta">December 15, 2021</p>
  </header>

  <article class="post-content">
    <h1 id="the-cryptominer">The cryptominer</h1>

<p>We used the Wasm cryptominer from bitcoinpeople.online.wasm and subjected it to wasm-mutate for a duration of 1 hour, resulting in 18,877 variations from the original program. The mutation process is wholly random. Given that each newly generated variant serves as the seed for the subsequent one, wasm-mutate progressively mutates the original cryptominer. After each binary is generated, we construct a square image, translating each byte in the binary into a grayscale value ranging from 0 to 255. Let’s examine the outcome.</p>

<div class="samples">
    <div class="sample">
        Original cryptominer.
        <img src="/assets/img/crypto/mutated.0.wasm.png" />
    </div>

    <div class="sample">
        1000 rotations after
        <img src="/assets/img/crypto/mutated.1000.wasm.png" />
    </div>
    <div class="sample">
        10000 rotations after
        <img src="/assets/img/crypto/mutated.10000.wasm.png" />
    </div>
    <div class="sample">
        18000 rotations after
        <img src="/assets/img/crypto/mutated.18870.wasm.png" />
    </div>
</div>

<h1 id="another-target">Another target</h1>

<p>We did the same for a Wasm binary that we knew was not a crypto miner. Check the
results.</p>

<div class="samples">
    <div class="sample">
        Original binary.
        <img src="/assets/img/crypto2/mutated.0.wasm.png" />
    </div>

    <div class="sample">
        1000 rotations after
        <img src="/assets/img/crypto2/mutated.1000.wasm.png" />
    </div>
    <div class="sample">
        10000 rotations after
        <img src="/assets/img/crypto2/mutated.10000.wasm.png" />
    </div>
    <div class="sample">
        18000 rotations after
        <img src="/assets/img/crypto2/mutated.18000.wasm.png" />
    </div>
</div>

<h1 id="some-preliminary-conclusions">Some preliminary conclusions</h1>

<h2 id="denoising">Denoising</h2>

<p>Adhering to the algorithm suggested in the MINOS study [?], we “reshaped” all images into 100x100 square pictures. This action represents the initial step in transforming Wasm binaries into images. We streamlined the succeeding steps of MINOS to enable a preliminary and manual evaluation of our obfuscation method.</p>

<p>We have noticed two phenomena. Firstly, following multiple iterations, the images derived from wasm-mutate variants begin to converge pixel values, implying that during the image conversion process, a cluster of pixels gets approximated to a single color value. This suggests that any two Wasm files, whether crypto-related or not, could be convoluted into the same image.</p>

<p>Secondly, we created two variant populations for two distinct binaries. Within these populations, we discovered pairs of variants (with one variant from the cryptominer and another from a non-crypto program) that closely resembled each other in terms of their imaging. This suggests that our method can effectively fool the human eye. We are presently replicating the classifier’s implementation to verify if wasm-mutate can indeed generate malware undetected by contemporary defenses.</p>

<p>Our final conjecture is that malware classifiers based on the “imaging” of Wasm binaries can be circumvented with the appropriate obfuscation process.</p>

  </article>

  
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname  = 'jacarte-github-io';
      var disqus_identifier = '/blog/2021/LazyTown';
      var disqus_title      = "Obfuscation experiment for some cryptominers.";
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    &copy; Copyright 2024 Javier  Cabrera Arteaga.
    Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.

    
  </div>
</footer>



  </body>

  <!-- Load Core and Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha512-/DXTXr6nQodMUiq+IUJYCt2PPOUjrHJ9wFrqpJ3XkgPNOZVfMok7cRw6CSxyCQxXn6ozlESsSh1/sMCTF1rL/g==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js"  integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/.css" />


<!-- Load KaTeX -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
<script src="/assets/js/katex.js"></script>



<!-- Load Mansory & imagesLoaded -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/masonry/4.2.2/masonry.pkgd.min.js" integrity="" crossorigin="anonymous"></script>
<script src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>

<!-- Project Cards Layout -->
<script type="text/javascript">
  // Init Masonry
  var $grid = $('.grid').masonry({
    gutter: 10,
    horizontalOrder: true,
    itemSelector: '.grid-item',
  });
  // layout Masonry after each image loads
  $grid.imagesLoaded().progress( function() {
    $grid.masonry('layout');
  });
</script>



<!-- Enable Tooltips -->
<script type="text/javascript">
$(function () {
  $('[data-toggle="tooltip"]').tooltip()
})
</script>



<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-127898106-1', 'auto');
ga('send', 'pageview');
</script>



</html>
